
import pandas as pd

def mergeTables(con, excon):
    try:
        steam_app_details = con.execute("SELECT * FROM steam_app_details").df()
        steam_spy = con.execute("SELECT * FROM steam_spy").df()
        steam_players = con.execute("SELECT * FROM steam_current_players").df()
        
        merge1 = pd.merge(steam_app_details, steam_spy, left_on='steam_appid', right_on='appid', how='inner')
        merge2 = pd.merge(merge1, steam_players, left_on='steam_appid', right_on='app_id', how='inner')

        merge2 = merge2[merge2["type"] == "game"]

        excon.execute("CREATE TABLE IF NOT EXISTS steam_games AS SELECT * FROM merge2")
    except Exception as e:
        print(f"An error occurred while merging tables: {e}")
        return False
    return True
