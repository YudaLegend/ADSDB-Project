import duckdb
def createTable(con, table_name, table_columns):

    # Validate input to prevent SQL injection
    if not isinstance(table_columns, list) or not all(isinstance(col, str) for col in table_columns):
        print("table_columns must be a list of column names (strings).")
        return False
    
    if not isinstance(table_name, str):
        print("table_name must be a string.")
        return False

    columns_str = ", ".join(table_columns)

    sql_query = f"""
    CREATE TABLE IF NOT EXISTS {table_name} AS
    SELECT DISTINCT {columns_str}
    FROM steam_games
    ORDER BY {columns_str} ASC
    """
    try:
        con.execute(sql_query)
    except Exception as e:
        print(f"An error occurred while creating table: {e}")
        return False
    return True
